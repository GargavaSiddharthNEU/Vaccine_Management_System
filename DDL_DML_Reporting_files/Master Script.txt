CREATE USER APP_ADMIN IDENTIFIED BY Datadojo2022;
CREATE USER HOSPITAL_ADMIN IDENTIFIED BY Datadojo2022;
CREATE USER MEDICAL_WORKER IDENTIFIED BY Datadojo2022;
CREATE USER RECIPIENT IDENTIFIED BY Datadojo2022;

GRANT CONNECT,RESOURCE TO APP_ADMIN;
GRANT CONNECT,RESOURCE TO HOSPITAL_ADMIN;
GRANT CONNECT,RESOURCE TO MEDICAL_WORKER;
GRANT CONNECT,RESOURCE TO RECIPIENT;

ALTER USER APP_ADMIN QUOTA UNLIMITED ON DATA;

ALTER USER HOSPITAL_ADMIN QUOTA 250M ON DATA;

ALTER USER MEDICAL_WORKER QUOTA 250M ON DATA;

ALTER USER RECIPIENT QUOTA 250M ON DATA;

SET SERVEROUTPUT ON;
declare
    is_true number;
begin
    select count(*) 
    INTO IS_TRUE
    from user_tables where table_name='VACCINE_RECORD';
    IF IS_TRUE > 0
    THEN
    EXECUTE IMMEDIATE 'DROP TABLE VACCINE_RECORD';
    END IF;
END;
/

declare
    is_true number;
begin
    select count(*) 
    INTO IS_TRUE
    from user_tables where table_name='REGISTRATION';
    IF IS_TRUE > 0
    THEN
    EXECUTE IMMEDIATE 'DROP TABLE REGISTRATION';
    END IF;
END;
/



declare
    is_true number;
begin
    select count(*) 
    INTO IS_TRUE
    from user_tables where table_name='MEDICAL_WORKER';
    IF IS_TRUE > 0
    THEN
    EXECUTE IMMEDIATE 'DROP TABLE MEDICAL_WORKER';
    END IF;
END;
/

declare
    is_true number;
begin
    select count(*) 
    INTO IS_TRUE
    from user_tables where table_name='VACCINE_DETAILS';
    IF IS_TRUE > 0
    THEN
    EXECUTE IMMEDIATE 'DROP TABLE VACCINE_DETAILS';
    END IF;
END;
/

declare
    is_true number;
begin
    select count(*) 
    INTO IS_TRUE
    from user_tables where table_name='HOSPITAL';
    IF IS_TRUE > 0
    THEN
    EXECUTE IMMEDIATE 'DROP TABLE HOSPITAL';
    END IF;
END;
/


declare
    is_true number;
begin
    select count(*) 
    INTO IS_TRUE
    from user_tables where table_name='RECIPIENT';
    IF IS_TRUE > 0
    THEN
    EXECUTE IMMEDIATE 'DROP TABLE RECIPIENT';
    END IF;
END;
/

declare
    is_true number;
begin
    select count(*) 
    INTO IS_TRUE
    from user_tables where table_name='AUDIT_LOG';
    IF IS_TRUE > 0
    THEN
    EXECUTE IMMEDIATE 'DROP TABLE AUDIT_LOG';
    END IF;
END;
/

CREATE TABLE RECIPIENT(
RECIPIENT_ID NUMBER CONSTRAINT RECIPIENT_PK PRIMARY KEY,
FIRST_NAME VARCHAR(90),
LAST_NAME VARCHAR(90),
DATE_OF_BIRTH DATE NOT NULL,
CONTACT_NUMBER NUMBER NOT NULL CONSTRAINT CONTACT_RECIPIENT_UNQ UNIQUE,
STREET_ADDRESS VARCHAR(120), 
CITY VARCHAR(50) NOT NULL,
ZIPCODE VARCHAR(10) NOT NULL,
GENDER VARCHAR(30) CONSTRAINT GENDER_RECIPIENT_CHECK CHECK(GENDER IN ('MALE','FEMALE','OTHER')) 
);

CREATE TABLE Audit_log( 
AUDIT_LOG_ID NUMBER CONSTRAINT AUDIT_LOG_PK PRIMARY KEY, 
LOG_DESCRIPTION VARCHAR(150) NOT NULL, 
OPERATION_TYPE VARCHAR(15),
RECIPIENT_ID NUMBER,
TIME_STAMP TIMESTAMP DEFAULT SYSTIMESTAMP
);

CREATE TABLE HOSPITAL(
HOSPITAL_ID NUMBER CONSTRAINT HOSPITAL_PK PRIMARY KEY,
HOSPITAL_NAME VARCHAR(90) NOT NULL,
HOSPITAL_STREET_ADDRESS VARCHAR(120),
CITY VARCHAR(50) NOT NULL,
ZIPCODE VARCHAR(10) NOT NULL,
HOSPITAL_CONTACT NUMBER NOT NULL CONSTRAINT HOSPITAL_CONTACT_UNQ UNIQUE,
HOSPITAL_LICENSE_NUMBER VARCHAR(50) NOT NULL CONSTRAINT HOSPITAL_LICENSE_UNQ UNIQUE
);


CREATE TABLE VACCINE_DETAILS(
VACCINE_ID NUMBER CONSTRAINT VACCINE_ID_PK PRIMARY KEY,
VACCINE_NAME VARCHAR(120) NOT NULL,
VIAL_SIZE NUMBER CONSTRAINT VIAL_SIZE_CHECK CHECK(VIAL_SIZE IN (10, 20, 30)),
LOT_ID VARCHAR(20) NOT NULL CONSTRAINT LOT_ID_UNQ UNIQUE,
MANUFACTURED_DATE DATE NOT NULL,
EXPIRY_DATE DATE NOT NULL
);

CREATE TABLE MEDICAL_WORKER(
MEDICAL_WORKER_ID NUMBER CONSTRAINT MEDICAL_WORKER_PK PRIMARY KEY,
FIRST_NAME VARCHAR(90),
LAST_NAME VARCHAR(90),
CONTACT_NUMBER NUMBER NOT NULL CONSTRAINT CONTACT_MEDICAL_WORKER_UNQ UNIQUE,
STREET_ADDRESS VARCHAR(120),
CITY VARCHAR(50) NOT NULL,
ZIPCODE VARCHAR(10) NOT NULL,
GENDER VARCHAR(30) CONSTRAINT GENDER_MEDICAL_WORKER_CHECK CHECK(GENDER IN ('MALE','FEMALE','OTHER')),
EMAIL_ID VARCHAR(40),
HOSPITAL_ID NUMBER NOT NULL CONSTRAINT HOSPITAL_ID_FK REFERENCES HOSPITAL(HOSPITAL_ID) ON DELETE CASCADE
);

CREATE TABLE REGISTRATION( 
REGISTRATION_ID NUMBER CONSTRAINT REGISTRATION_PK PRIMARY KEY, 
RECIPIENT_ID NUMBER NOT NULL CONSTRAINT RECIPIENT_ID_FK REFERENCES RECIPIENT(RECIPIENT_ID) ON DELETE CASCADE, 
USERNAME VARCHAR(20) NOT NULL CONSTRAINT USERNAME_UNQ UNIQUE, 
PASS_WORD VARCHAR(50) NOT NULL, 
EMAIL_ID VARCHAR(50) NOT NULL, 
LAST_VACCINATION_DATE DATE, 
PAYMENT_TIMESTAMP TIMESTAMP NOT NULL, 
PAYMENT_AMOUNT NUMBER NOT NULL, 
TRANSACTION_ID VARCHAR(20) NOT NULL CONSTRAINT TRANSACTION_ID_UNQ UNIQUE, 
PAYMENT_TYPE VARCHAR(20) CONSTRAINT PAYMENT_TYPE_CHECK CHECK(PAYMENT_TYPE IN ('CARD','CASH')) 
);

CREATE TABLE VACCINE_RECORD( 
VACCINE_RECORD_ID NUMBER CONSTRAINT VACCINE_RECORD_PK PRIMARY KEY, 
START_TIME TIMESTAMP NOT NULL, 
END_TIME TIMESTAMP NOT NULL, 
VACCINE_RECORD_DATE DATE DEFAULT SYSDATE, 
REMARKS VARCHAR(150), 
MEDICAL_WORKER_ID NUMBER NOT NULL CONSTRAINT MEDICAL_WORKER_ID_FK REFERENCES MEDICAL_WORKER(MEDICAL_WORKER_ID) ON DELETE CASCADE, 
REGISTRATION_ID NUMBER NOT NULL CONSTRAINT REGISTRATION_ID_FK REFERENCES REGISTRATION(REGISTRATION_ID) ON DELETE CASCADE, 
VACCINE_ID NUMBER NOT NULL CONSTRAINT VACCINE_ID_FK REFERENCES VACCINE_DETAILS(VACCINE_ID) ON DELETE CASCADE 
);

GRANT SELECT,INSERT ON REGISTRATION TO RECIPIENT;
GRANT SELECT ON VACCINE_RECORD TO RECIPIENT;

GRANT SELECT, INSERT, UPDATE, DELETE ON MEDICAL_WORKER TO HOSPITAL_ADMIN;
GRANT SELECT ON VACCINE_DETAILS TO HOSPITAL_ADMIN;
GRANT SELECT ON VACCINE_RECORD TO HOSPITAL_ADMIN;
GRANT SELECT ON REGISTRATION TO HOSPITAL_ADMIN;

GRANT SELECT, INSERT, UPDATE ON VACCINE_RECORD TO MEDICAL_WORKER;
GRANT SELECT ON VACCINE_DETAILS TO MEDICAL_WORKER;
GRANT SELECT ON REGISTRATION TO MEDICAL_WORKER;

---------------------------------------

--RECIPIENT-BY APP ADMIN

INSERT INTO RECIPIENT(RECIPIENT_ID,FIRST_NAME,LAST_NAME,DATE_OF_BIRTH,CONTACT_NUMBER,STREET_ADDRESS,CITY,ZIPCODE,GENDER)
VALUES(101,'ALLEN','SMITH','23-OCT-1997',6172344342,'234 HUNTINGTON AVE','BOSTON','02115','MALE');
INSERT INTO RECIPIENT(RECIPIENT_ID,FIRST_NAME,LAST_NAME,DATE_OF_BIRTH,CONTACT_NUMBER,STREET_ADDRESS,CITY,ZIPCODE,GENDER)
VALUES(102,'AVA','CHEN','07-MAR-1990',8769971678,'3760 ARCHER ROAD','MATTAPAN','02124','FEMALE');
INSERT INTO RECIPIENT(RECIPIENT_ID,FIRST_NAME,LAST_NAME,DATE_OF_BIRTH,CONTACT_NUMBER,STREET_ADDRESS,CITY,ZIPCODE,GENDER)
VALUES(103,'JAMES','MCMILLAN','12-JUL-1970',4123478001,'1667 K STREET','WASHINGTON DC','20006','OTHER');
INSERT INTO RECIPIENT(RECIPIENT_ID,FIRST_NAME,LAST_NAME,DATE_OF_BIRTH,CONTACT_NUMBER,STREET_ADDRESS,CITY,ZIPCODE,GENDER)
VALUES(104,'RAKSHA','SHETTY','30-OCT-1995',8577990915,'682 PARKER SREET','BOSTON','02120','FEMALE');
INSERT INTO RECIPIENT(RECIPIENT_ID,FIRST_NAME,LAST_NAME,DATE_OF_BIRTH,CONTACT_NUMBER,STREET_ADDRESS,CITY,ZIPCODE,GENDER)
VALUES(105,'ELLA','GLENN','20-MAR-2000',4132344890,'1255 RARITAN ROAD','CLARK','07066','OTHER');
INSERT INTO RECIPIENT(RECIPIENT_ID,FIRST_NAME,LAST_NAME,DATE_OF_BIRTH,CONTACT_NUMBER,STREET_ADDRESS,CITY,ZIPCODE,GENDER)
VALUES(106,'RAHMAN','AHMAD','30-NOV-1960',3134500761,'1515 CLAY STREET','LOS ANGELES','94612','MALE');
INSERT INTO RECIPIENT(RECIPIENT_ID,FIRST_NAME,LAST_NAME,DATE_OF_BIRTH,CONTACT_NUMBER,STREET_ADDRESS,CITY,ZIPCODE,GENDER)
VALUES(107,'GRAYSON','HARPER','14-AUG-1990',6167890915,'66 SPARKS STREET','CAMBRIDGE','02163','MALE');
INSERT INTO RECIPIENT(RECIPIENT_ID,FIRST_NAME,LAST_NAME,DATE_OF_BIRTH,CONTACT_NUMBER,STREET_ADDRESS,CITY,ZIPCODE,GENDER)
VALUES(108,'SANIA','MEADOWS','06-APR-1998',7173124098,'3014 WEST COLUMBUS AVE','CHICAGO','60652','OTHER');
INSERT INTO RECIPIENT(RECIPIENT_ID,FIRST_NAME,LAST_NAME,DATE_OF_BIRTH,CONTACT_NUMBER,STREET_ADDRESS,CITY,ZIPCODE,GENDER)
VALUES(109,'LILY','CALLOWAY','28-MAY-1996',8179708654,'3100 NEWPORT AVE','NEWPORT BEACH','92660','FEMALE');
INSERT INTO RECIPIENT(RECIPIENT_ID,FIRST_NAME,LAST_NAME,DATE_OF_BIRTH,CONTACT_NUMBER,STREET_ADDRESS,CITY,ZIPCODE,GENDER)
VALUES(110,'STELLA','ALONSO','16-FEB-1997',9180675421,'235TH SOUTHEAST STREET','KENT','98031','FEMALE');

-------------------------------------------------------------------
--HOSPITAL - BY APP ADMIN

INSERT INTO HOSPITAL (HOSPITAL_ID,HOSPITAL_NAME,HOSPITAL_STREET_ADDRESS,CITY,ZIPCODE,HOSPITAL_CONTACT,HOSPITAL_LICENSE_NUMBER) 
VALUES 
(1101,'MASS BRIGHAM GENERAL HOSPITAL','243 CHARLES STREET','BOSTON','02114',4146772234,'ACH12345HOSP');
INSERT INTO HOSPITAL (HOSPITAL_ID,HOSPITAL_NAME,HOSPITAL_STREET_ADDRESS,CITY,ZIPCODE,HOSPITAL_CONTACT,HOSPITAL_LICENSE_NUMBER) 
VALUES 
(1102,'ILLINOIS GENERAL HOSPITAL','1310 COMMONS DRIVE','CHICAGO','60134',3124433567,'ILL3425HOSP');
INSERT INTO HOSPITAL (HOSPITAL_ID,HOSPITAL_NAME,HOSPITAL_STREET_ADDRESS,CITY,ZIPCODE,HOSPITAL_CONTACT,HOSPITAL_LICENSE_NUMBER) 
VALUES 
(1103,'SOUTHERN CALIFORNIA HOSPITAL','6245 DE LONGPRE AVE','LOS ANGELES','90015',6167090808,'LAG2908HOSP');
INSERT INTO HOSPITAL (HOSPITAL_ID,HOSPITAL_NAME,HOSPITAL_STREET_ADDRESS,CITY,ZIPCODE,HOSPITAL_CONTACT,HOSPITAL_LICENSE_NUMBER) 
VALUES 
(1104,'GWU HOSPITAL','900 23RD STREET','WASHINGTON DC','20037',7178907070,'WAS7178HOSP');

-----------------------------------------------------------------------
--VACCINE_DETAILS- By APP ADMIN
 
INSERT INTO VACCINE_DETAILS (VACCINE_ID,VACCINE_NAME,VIAL_SIZE,LOT_ID,MANUFACTURED_DATE,EXPIRY_DATE) 
VALUES(301,'JJ',20,'LOT6798','08-AUG-2021','06-NOV-2023');

INSERT INTO VACCINE_DETAILS (VACCINE_ID,VACCINE_NAME,VIAL_SIZE,LOT_ID,MANUFACTURED_DATE,EXPIRY_DATE) 
VALUES(302,'MODERNA',10,'LOT4567','07-JUN-2022','05-SEP-2023');
 
INSERT INTO VACCINE_DETAILS (VACCINE_ID,VACCINE_NAME,VIAL_SIZE,LOT_ID,MANUFACTURED_DATE,EXPIRY_DATE) 
VALUES(303,'PFIZER',30,'LOT1234','21-NOV-2021','19-AUG-2023');

INSERT INTO VACCINE_DETAILS (VACCINE_ID,VACCINE_NAME,VIAL_SIZE,LOT_ID,MANUFACTURED_DATE,EXPIRY_DATE) 
VALUES(304,'NOVAVAX',10,'LOT5123','17-JAN-2022','06-FEB-2022');

----------------------------------------------------------------------------------
--MEDICAL_WORKER BY HOSPITAL_ADMIN

INSERT INTO APP_ADMIN.MEDICAL_WORKER(MEDICAL_WORKER_ID,FIRST_NAME,LAST_NAME,CONTACT_NUMBER,STREET_ADDRESS, 
CITY,ZIPCODE,HOSPITAL_ID,GENDER,EMAIL_ID) 
VALUES 
(12011,'JOHN','GLOVER',6172344342,'225 HUNTINGTON AVE','BOSTON','02115',1101,'MALE','g.john@gmail.com');


INSERT INTO APP_ADMIN.MEDICAL_WORKER(MEDICAL_WORKER_ID,FIRST_NAME,LAST_NAME,CONTACT_NUMBER,STREET_ADDRESS, 
CITY,ZIPCODE,HOSPITAL_ID,GENDER,EMAIL_ID) 
VALUES 
(12012,'FIONA','DALTON',8769971678,'3760 ARCHER ROAD','WASHINGTON DC','20030',1104,'FEMALE','d.fio@gmail.com');


INSERT INTO APP_ADMIN.MEDICAL_WORKER(MEDICAL_WORKER_ID,FIRST_NAME,LAST_NAME,CONTACT_NUMBER,STREET_ADDRESS, 
CITY,ZIPCODE,HOSPITAL_ID,GENDER,EMAIL_ID) 
VALUES 
(12013,'DAMIEN','LAURENT',5678902341,'245 CLEMENT STREET','SPRINGFIELD','60124',1102,'MALE','ian.rent@gmail.com'); 


INSERT INTO APP_ADMIN.MEDICAL_WORKER(MEDICAL_WORKER_ID,FIRST_NAME,LAST_NAME,CONTACT_NUMBER,STREET_ADDRESS, 
CITY,ZIPCODE,HOSPITAL_ID,GENDER,EMAIL_ID) 
VALUES 
(12014,'LAURA','WELLING',4145897654,'22 CONECTICUT AVE','SOMERVILLE','02144',1101,'OTHER','wellslaura@gmail.com'); 


INSERT INTO APP_ADMIN.MEDICAL_WORKER(MEDICAL_WORKER_ID,FIRST_NAME,LAST_NAME,CONTACT_NUMBER,STREET_ADDRESS, 
CITY,ZIPCODE,HOSPITAL_ID,GENDER,EMAIL_ID) 
VALUES 
(12015,'ANA','COUNSELOS',3137890915,'5200 HOLLYWOOD BVLD','LOS ANGELES','90027',1103,'FEMALE','counselos.ana@gmail.com');


INSERT INTO APP_ADMIN.MEDICAL_WORKER(MEDICAL_WORKER_ID,FIRST_NAME,LAST_NAME,CONTACT_NUMBER,STREET_ADDRESS, 
CITY,ZIPCODE,HOSPITAL_ID,GENDER,EMAIL_ID) 
VALUES 
(12016,'ELLIOT','GONZALEZ',7128907654,'4426 CARNABY STREET','SPOKANE','99203',1104,'OTHER','gonzalezell@gmail.com');


INSERT INTO APP_ADMIN.MEDICAL_WORKER(MEDICAL_WORKER_ID,FIRST_NAME,LAST_NAME,CONTACT_NUMBER,STREET_ADDRESS, 
CITY,ZIPCODE,HOSPITAL_ID,GENDER,EMAIL_ID) 
VALUES 
(12017,'BRIANA','SCOTT',8137126708,'4600 WEST 65TH STREET','CHICAGO','60629',1102,'FEMALE','briscott@gmail.com');


INSERT INTO APP_ADMIN.MEDICAL_WORKER(MEDICAL_WORKER_ID,FIRST_NAME,LAST_NAME,CONTACT_NUMBER,STREET_ADDRESS, 
CITY,ZIPCODE,HOSPITAL_ID,GENDER,EMAIL_ID) 
VALUES 
(12018,'JUAN','DSILVA',6132897654,'884 BURTON GROVE','LOS ANGELES','90048',1103,'MALE','juan.dsilva@gmail.com');


INSERT INTO APP_ADMIN.MEDICAL_WORKER(MEDICAL_WORKER_ID,FIRST_NAME,LAST_NAME,CONTACT_NUMBER,STREET_ADDRESS, 
CITY,ZIPCODE,HOSPITAL_ID,GENDER,EMAIL_ID) 
VALUES 
(12019,'ANIKA','SMITH',8576432190,'40 HARRIET AVENUE','QUINCY','02171',1101,'OTHER','anikaquincy@gmail.com'); 


--------------------------------------------------------------------------------------------------

--REGISTRATION BY RECIPIENT 

INSERT INTO APP_ADMIN.REGISTRATION(REGISTRATION_ID,RECIPIENT_ID,USERNAME,PASS_WORD,EMAIL_ID,LAST_VACCINATION_DATE,PAYMENT_TIMESTAMP,
PAYMENT_AMOUNT,TRANSACTION_ID,PAYMENT_TYPE)VALUES
(50011,101,'al.smith','Katara@i345','allen.smith@gmail.com','08-JUN-2021','07-NOV-2021 09:30:45',20,'TRANS234190','CARD');
INSERT INTO APP_ADMIN.REGISTRATION (REGISTRATION_ID,RECIPIENT_ID,USERNAME,PASS_WORD,EMAIL_ID,LAST_VACCINATION_DATE,PAYMENT_TIMESTAMP,
PAYMENT_AMOUNT,TRANSACTION_ID,PAYMENT_TYPE)VALUES
(50012,102,'chen.aves','Volkov@0123','chenava@gmail.com',NULL,'19-SEP-2021 10:45:09',15,'TRANS414289','CARD');
INSERT INTO APP_ADMIN.REGISTRATION (REGISTRATION_ID,RECIPIENT_ID,USERNAME,PASS_WORD,EMAIL_ID,LAST_VACCINATION_DATE,PAYMENT_TIMESTAMP,
PAYMENT_AMOUNT,TRANSACTION_ID,PAYMENT_TYPE)VALUES
(50013,105,'ellyshines','Sunflower@8909','glenn.elle@gmail.com',NULL,'15-NOV-2021 10:16:09',20,'TRANS356741','CARD');
INSERT INTO APP_ADMIN.REGISTRATION (REGISTRATION_ID,RECIPIENT_ID,USERNAME,PASS_WORD,EMAIL_ID,LAST_VACCINATION_DATE,PAYMENT_TIMESTAMP,
PAYMENT_AMOUNT,TRANSACTION_ID,PAYMENT_TYPE)VALUES
(50014,103,'macjames','ZatarIstanbul#2010','mcmillianjay@gmail.com','28-FEB-2022','20-JUL-2022 08:00:45',20,'TRANS313267','CASH');
INSERT INTO APP_ADMIN.REGISTRATION (REGISTRATION_ID,RECIPIENT_ID,USERNAME,PASS_WORD,EMAIL_ID,LAST_VACCINATION_DATE,PAYMENT_TIMESTAMP,
PAYMENT_AMOUNT,TRANSACTION_ID,PAYMENT_TYPE)VALUES
(50015,104,'shettyraksha','Shriveling@2022','shetty.raks@gmail.com','20-MAR-2020','27-NOV-2020 09:45:09',20,'TRANS564689','CARD');
INSERT INTO APP_ADMIN.REGISTRATION (REGISTRATION_ID,RECIPIENT_ID,USERNAME,PASS_WORD,EMAIL_ID,LAST_VACCINATION_DATE,PAYMENT_TIMESTAMP,
PAYMENT_AMOUNT,TRANSACTION_ID,PAYMENT_TYPE)VALUES
(50016,106,'ahmadrah','dRagonZ#12680','rahman.ahmad@gmail.com',NULL,'12-APR-2022 10:39:08',15,'TRANS908715','CARD');
INSERT INTO APP_ADMIN.REGISTRATION (REGISTRATION_ID,RECIPIENT_ID,USERNAME,PASS_WORD,EMAIL_ID,LAST_VACCINATION_DATE,PAYMENT_TIMESTAMP,
PAYMENT_AMOUNT,TRANSACTION_ID,PAYMENT_TYPE)VALUES
(50017,108,'saniameadows','LavenderHaze@13','sunshine.meadows@gmail.com','23-MAY-2022','15-OCT-2022 08:21:34',20,'TRANS873412','CARD');
INSERT INTO APP_ADMIN.REGISTRATION (REGISTRATION_ID,RECIPIENT_ID,USERNAME,PASS_WORD,EMAIL_ID,LAST_VACCINATION_DATE,PAYMENT_TIMESTAMP,
PAYMENT_AMOUNT,TRANSACTION_ID,PAYMENT_TYPE)VALUES
(50018,107,'grayharper','HawThorne@1324','harpergrayson@gmail.com','05-JAN-2022','20-AUG-2022 11:25:06',20,'TRANS213890','CARD');
INSERT INTO APP_ADMIN.REGISTRATION (REGISTRATION_ID,RECIPIENT_ID,USERNAME,PASS_WORD,EMAIL_ID,LAST_VACCINATION_DATE,PAYMENT_TIMESTAMP,
PAYMENT_AMOUNT,TRANSACTION_ID,PAYMENT_TYPE)VALUES
(50019,110,'stellashines','FasHion@TRen47','alonso.stella@gmailcom',NULL,'22-SEP-2022 10:08:56',15,'TRANS314267','CASH');
INSERT INTO APP_ADMIN.REGISTRATION (REGISTRATION_ID,RECIPIENT_ID,USERNAME,PASS_WORD,EMAIL_ID,LAST_VACCINATION_DATE,PAYMENT_TIMESTAMP,
PAYMENT_AMOUNT,TRANSACTION_ID,PAYMENT_TYPE)VALUES
(50020,109,'lillycalos','ConnoCobalt@30','calloway.lilly@gmail.com','20-NOV-2021','20-MAR-2022 08:25:46',20,'TRANS240981','CARD');

--------------------------------------------------------------------------------------------------------

--VACCINE_RECORD BY MEDICAL_WORKER

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60111,'08-JUN-2021 09:00:30','08-JUN-2021 10:00:20','08-JUN-2021','NULL',12011,50011,302); 

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60112,'20-SEP-2021 10:30:04','20-SEP-2021 11:30:20','20-SEP-2021','SIGNS OF DIZZINESS AFTER VACCINATION',12014,50012,301);

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60113,'20-MAR-2020 10:00:07','20-MAR-2020 11:20:43','20-MAR-2020','NULL',12014,50015,304);
 
INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60114,'17-NOV-2021 11:15:10','17-NOV-2021 12:00:00','17-NOV-2021','SIGNS OF NAUSEA AND DIZZINESS AFTER VACCINATION',12012,50013,303); 

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60115,'10-NOV-2021 09:30:23','10-NOV-2021 10:20:30','10-NOV-2021','NULL',12014,50011,302);

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60116,'20-NOV-2021 11:20:34','20-NOV-2021 12:00:00','20-NOV-2021','NULL',12015 ,50020,303);
 
INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60117,'29-NOV-2020 08:35:23','29-NOV-2020 09:20:24','29-NOV-2020','NULL',12019,50015,304);
 
INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60118,'28-FEB-2022 10:35:23','28-FEB-2022 11:20:23','28-FEB-2022','SIGNS OF NAUSEA AFTER VACCINATION',12012,50014,301);
 
INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60119,'05-JAN-2022 10:45:20','05-JAN-2022 11:39:21','05-JAN-2022','NULL',12019,50018,302);
 
INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60120,'23-MAY-2022 10:30:09','23-MAY-2022 11:25:10','23-MAY-2022','SIGNS OF DIZZINESS AFTER VACCINATION',12017,50017,304);

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60121,'12-APR-2022 10:40:20','12-APR-2022 11:20:08','12-APR-2022','SIGNS OF NAUSEA AFTER VACCINATION',12018,50016,302); 

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60122,'30-SEP-2022 08:30:20','30-SEP-2022 09:20:03','30-SEP-2022','NULL',12015,50016,302);

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60123,'20-JUL-2022 10:00:30','20-JUL-2022 11:05:04','20-JUL-2022','NULL',12012,50014,301);
 
INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60124,'07-JAN-2022 10:30:20','07-JAN-2022 11:30:30','07-JAN-2022','NULL',12011,50012,301);

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60125,'02-FEB-2022 09:15:20','02-FEB-2022 10:20:26','02-FEB-2022','NULL',12012,50013,303);

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60126,'22-MAR-2022 09:30:10','22-MAR-2022 10:25:56','22-MAR-2022','NULL',12018,50020,303);

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60127,'21-MAR-2022 10:30:08','21-MAR-2022 11:20:34','21-MAR-2022','SIGNS OF FATIGUE AFTER VACCINATION',12013,50019,302);

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60128,'17-OCT-2022 10:30:56','17-OCT-2022 11:20:34','17-OCT-2022','NULL',12013,50017,304);

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60129,'20-AUG-2022 10:20:34','20-AUG-2022 11:23:45','20-AUG-2022','NULL',12011,50018,302);

INSERT INTO APP_ADMIN.VACCINE_RECORD (VACCINE_RECORD_ID,START_TIME,END_TIME,VACCINE_RECORD_DATE,REMARKS,MEDICAL_WORKER_ID, 
REGISTRATION_ID,VACCINE_ID) 
VALUES (60130,'21-SEP-2022 10:20:34','21-SEP-2022 11:25:50','21-SEP-2022','NULL',12017,50019,302); 


--VIEWS SCRIPTS
--View1
CREATE OR REPLACE VIEW RECIPIENT_DETAILS AS
SELECT RP.RECIPIENT_ID,RG.REGISTRATION_ID,RP.FIRST_NAME, RP.LAST_NAME,
RP.DATE_OF_BIRTH,RP.CONTACT_NUMBER,RP.STREET_ADDRESS, RP.CITY,RP.ZIPCODE,RP.GENDER, 
RG.EMAIL_ID,RG.LAST_VACCINATION_DATE,VACCINE_RECORD_ID,VR.VACCINE_RECORD_DATE,VR.REMARKS,
HP.HOSPITAL_ID,HP.HOSPITAL_NAME,MW.MEDICAL_WORKER_ID,VD.VACCINE_ID,VD.VACCINE_NAME

FROM RECIPIENT RP
JOIN REGISTRATION RG ON
RG.RECIPIENT_ID = RP.RECIPIENT_ID
JOIN VACCINE_RECORD VR ON
VR.REGISTRATION_ID = RG.REGISTRATION_ID
JOIN MEDICAL_WORKER MW ON
MW.MEDICAL_WORKER_ID = VR.MEDICAL_WORKER_ID
JOIN HOSPITAL HP ON
HP.HOSPITAL_ID = MW.HOSPITAL_ID
JOIN VACCINE_DETAILS VD ON
VD.VACCINE_ID = VR.VACCINE_ID;

--View2
CREATE OR REPLACE VIEW HOSPITAL_WISE_TOTAL_VACCINE_ADMINISTERED AS

SELECT H.HOSPITAL_ID, H.HOSPITAL_NAME,COUNT(VR.VACCINE_RECORD_ID) AS TOTAL_VACCINE_ADMINISTERED

FROM HOSPITAL H
JOIN MEDICAL_WORKER MW ON
MW.HOSPITAL_ID = H.HOSPITAL_ID
JOIN VACCINE_RECORD VR ON 
VR.MEDICAL_WORKER_ID = MW.MEDICAL_WORKER_ID

GROUP BY H.HOSPITAL_ID,H.HOSPITAL_NAME;


--View3
CREATE OR REPLACE VIEW MEDICAL_WORKER_WISE_TOTAL_VACCINE_ADMINISTERED AS

SELECT MW.MEDICAL_WORKER_ID, MW.FIRST_NAME,COUNT(VR.VACCINE_RECORD_ID) AS TOTAL_VACCINE_ADMINISTERED

FROM HOSPITAL H
JOIN MEDICAL_WORKER MW ON
MW.HOSPITAL_ID = H.HOSPITAL_ID
JOIN VACCINE_RECORD VR ON 
VR.MEDICAL_WORKER_ID = MW.MEDICAL_WORKER_ID

GROUP BY MW.MEDICAL_WORKER_ID,MW.FIRST_NAME;

--View4
CREATE OR REPLACE VIEW REGION_WISE_TOTAL_VACCINE_ADMINISTERED AS

SELECT H.CITY, COUNT(VR.VACCINE_RECORD_ID) AS TOTAL_VACCINE_ADMINISTERED

FROM HOSPITAL H
JOIN MEDICAL_WORKER MW ON
MW.HOSPITAL_ID = H.HOSPITAL_ID
JOIN VACCINE_RECORD VR ON 
VR.MEDICAL_WORKER_ID = MW.MEDICAL_WORKER_ID

GROUP BY H.CITY;

--View5
CREATE OR REPLACE VIEW WEEK_WISE_TOTAL_VACCINE_ADMINISTERED AS
SELECT to_char(to_date(VR.VACCINE_RECORD_DATE,'DD/MON/YYYY'),'WW/YY')AS WEEK,
COUNT(vr.vaccine_record_id) AS TOTAL_VACCINE_ADMINISTERED

FROM HOSPITAL H
JOIN MEDICAL_WORKER MW ON
MW.HOSPITAL_ID = H.HOSPITAL_ID
JOIN VACCINE_RECORD VR ON 
VR.MEDICAL_WORKER_ID = MW.MEDICAL_WORKER_ID
JOIN VACCINE_DETAILS VD ON
VD.VACCINE_ID = VR.VACCINE_ID

GROUP BY VR.VACCINE_RECORD_DATE

ORDER BY VR.VACCINE_RECORD_DATE ASC;

--View6
CREATE OR REPLACE VIEW VACCINE_TYPE_WISE_ADMINISTERED AS
SELECT VD.VACCINE_NAME, COUNT(VR.VACCINE_RECORD_ID) AS TOTAL_VACCINE_TYPE

FROM HOSPITAL H
JOIN MEDICAL_WORKER MW ON
MW.HOSPITAL_ID = H.HOSPITAL_ID
JOIN VACCINE_RECORD VR ON 
VR.MEDICAL_WORKER_ID = MW.MEDICAL_WORKER_ID
JOIN VACCINE_DETAILS VD ON
VD.VACCINE_ID = VR.VACCINE_ID

GROUP BY VACCINE_NAME;

--View7
CREATE OR REPLACE VIEW TOTAL_BILLING_BY_HOSPITAL AS
SELECT H.HOSPITAL_ID,H.HOSPITAL_NAME,SUM(RG.PAYMENT_AMOUNT) AS TOTAL_BILLING

FROM HOSPITAL H
JOIN MEDICAL_WORKER MW ON
MW.HOSPITAL_ID = H.HOSPITAL_ID
JOIN VACCINE_RECORD VR ON
VR.MEDICAL_WORKER_ID = MW.MEDICAL_WORKER_ID
JOIN REGISTRATION RG ON
RG.REGISTRATION_ID = VR.REGISTRATION_ID

GROUP BY H.HOSPITAL_ID,H.HOSPITAL_NAME;

--View8
CREATE OR REPLACE VIEW TRAILING_DAY_WISE_TOTAL_VACCINE_ADMINISTERED AS
SELECT VACCINE_RECORD_DATE, COUNT(VACCINE_RECORD_ID) AS TOTAL_VACCINE_ADMINISTERED

FROM VACCINE_RECORD

GROUP BY VACCINE_RECORD_DATE
ORDER BY VACCINE_RECORD_DATE ASC;

--View9
CREATE OR REPLACE VIEW VACCINE_EFFICACY AS
SELECT VD.VACCINE_NAME,
concat((SUM(CASE WHEN VR.REMARKS = 'NULL' THEN 1 ELSE 0 END)/COUNT(VR.REMARKS))*100, '%') AS EFFICACY

FROM VACCINE_RECORD VR  
JOIN VACCINE_DETAILS VD ON
VD.VACCINE_ID = VR.VACCINE_ID

GROUP BY VD.VACCINE_NAME;

--ALL VIEWS select
SELECT * FROM HOSPITAL_WISE_TOTAL_VACCINE_ADMINISTERED;

SELECT * FROM MEDICAL_WORKER_WISE_TOTAL_VACCINE_ADMINISTERED;

SELECT * FROM RECIPIENT_DETAILS;

SELECT * FROM REGION_WISE_TOTAL_VACCINE_ADMINISTERED;

SELECT * FROM TOTAL_BILLING_BY_HOSPITAL;

SELECT * FROM TRAILING_DAY_WISE_TOTAL_VACCINE_ADMINISTERED;

SELECT * FROM VACCINE_EFFICACY;

SELECT * FROM VACCINE_TYPE_WISE_ADMINISTERED;

SELECT * FROM WEEK_WISE_TOTAL_VACCINE_ADMINISTERED; 